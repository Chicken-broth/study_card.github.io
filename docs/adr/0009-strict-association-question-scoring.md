# 9. 組み合わせ問題における厳格な採点方式の導入

- **ステータス:** 承認済み
- **日付:** 2025-09-09

## コンテキスト

これまで、組み合わせ問題の採点ロジックは寛容なものでした。過程で何度間違ったとしても、最終的にすべてのペアが正しく一致すれば、その問題は「正解」と判定されていました。これでは、ユーザーの最初の理解度を正確に反映することができませんでした。

## 決定

より厳格な採点ロジックを導入することを決定しました。ユーザーが一度でも不正解のペアを選択した場合、その組み合わせ問題全体が即座に、かつその回答セッション中は永続的に「不正解」としてマークされます。

この変更をサポートするため、現在の回答状態（正解、不正解、未回答）をUIに表示し、ユーザーに即時フィードバックを提供することも決定しました。

## 結果

- **コードの変更点:**
  - `client/app/src/core/association_question.gleam` の `Model` に、間違いを犯したかを記録する `has_made_mistake: Bool` フラグが追加されました。
  - `handle_pair_selection` 関数は、最初の不正解のマッチでこのフラグを `True` に設定するようになりました。
  - `check_answer` 関数は、このフラグを考慮し、間違いがあった場合は `Incorrect` を返すように変更されました。
  - `view` 関数が更新され、結果を画面に表示するための `view_answer_status` ヘルパーが追加されました。
- **ユーザーエクスペリエンスへの影響:**
  - ユーザーは、自身の解答に対するより明確で即時的なフィードバックを受け取れるようになります。
  - 採点結果が、解答時点でのユーザーの知識をより正確に反映するようになります。
