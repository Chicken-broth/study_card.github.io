# 3. データベースソースの切り替え機能

**ステータス:** 実装中

**コンテキスト:**

現在の実装では、単一の問題集しか利用できません。ユーザーが異なるトピック（例：基本情報、応用情報）や、異なるバージョンの問題集（例：2024年版、2025年版）を学習できるようにするため、使用するデータベース（問題集）を切り替える機能が必要です。

**決定事項:**

`indexedDB`の`setup`関数に、data set名を指定する新しい引数 `data_set_name` を追加します。UI（クイズホーム画面）には、利用可能な問題集（DB名）のリストをドロップダウンで表示し、ユーザーが選択できるようにします。選択されたDB名はアプリケーションの状態として保持し、`setup`関数に渡されます。

**考慮事項:**

-   **選択肢A: 1つのDB内でカテゴリによって問題集を区別する**
    -   **長所:** DB接続の切り替えが不要で、実装が比較的容易。
    -   **短所:** データ構造が複雑になり、将来的に問題集ごとの設定（例：タイマーの有無）を追加しにくい。
-   **選択肢B: DBごとに異なるIndexedDBインスタンスを使用する**
    -   **長所:** 問題集ごとに完全に独立したデータ管理が可能。将来的な拡張性（問題集ごとの設定など）が高い。
    -   **短所:** DB接続の切り替えロジックが必要になり、実装がやや複雑になる。

**決定:**

**選択肢B** を採用します。これにより、問題集ごとに独立したデータ管理が可能となり、将来的な拡張性（例: 問題集ごとの設定、進捗管理）が高まります。

**変更点:**

1.  `indexedDB_ffi.mjs` に、`dbName` に応じて動的に問題集データ (`data.mjs` または `extra.mjs`) をインポートするロジックを追加します。
2.  `indexedDB.gleam` の `setup` 関数のシグネチャに `data_set_name` 引数を追加します。
3.  `quiz_home.gleam` に、UIでDB選択のドロップダウンを追加し、選択に応じてDBを再初期化するロジックを実装します。
4.  `indexedDB_test.gleam` を更新し、DB切り替え機能が正しく動作することを確認するテストケースを追加します。
**結果:**
-   ユーザーはアプリケーション内で異なる問題集を切り替えて学習できるようになります。
-   問題集ごとに独立した学習履歴や進捗管理が可能になります。
-   **影響範囲:** `quiz_home.gleam`のUI変更、`indexed_db.gleam`の`setup`関数のシグネチャ変更、アプリケーションの`Model`に選択中のDB名を保持するフィールドの追加が必要になります。-   
-   **関連タスク**: TASK-206

-   **利点:** 複数の問題集をサポートできるようになり、アプリケーションの拡張性が向上します。
-   **リスク:** DB名の管理が煩雑になる可能性があります。将来的には、利用可能なDB名のリストを動的に取得する仕組みが必要になるかもしれません。