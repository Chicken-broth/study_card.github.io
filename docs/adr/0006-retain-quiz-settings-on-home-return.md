# 6. リザルト画面からHome画面に戻る際のクイズ設定保持

**ステータス**: 実装済み

## コンテキスト

- 現状の実装では、リザルト画面からHome画面に戻ると、ユーザーが選択したクイズの設定（カテゴリ、出題数、オプションなど）がすべて初期状態にリセットされてしまう。
- ユーザーが同じ条件で再挑戦したり、少しだけ条件を変えて挑戦したりする場合、毎回すべての項目を設定し直す必要があり、UX（ユーザー体験）を損なっている。

## 決定

- アプリケーションのトップレベルの状態（`study_app.Model`）で、画面遷移後もHome画面の状態（`quiz_home.Model`）を保持する。
- 具体的には、`QuizScreen` と `QuizResult` の型定義を `QuizScreen(quiz_home.Model, quiz_screen.Model)` のように変更し、遷移前の `quiz_home.Model` を引数として渡す。
- リザルト画面からHome画面に戻る際には、`quiz_home.init` でモデルを再初期化するのではなく、保持していた `quiz_home.Model` を再利用する。
- これにより、ブラウザをリロードしない限り、ユーザーの選択状態が維持される。

## 検討された選択肢

### 1. Local Storageに保存する

- **メリット**: ユーザーがブラウザをリロードしたり、一度タブを閉じたりしても設定が保持される。
- **デメリット**:
  - JavaScriptとの連携（FFI）が必要になり、実装が複雑になる。
  - 状態の保存・読み込みのために、JSONへのシリアライズ・デシリアライズ処理が別途必要になる。

### 2. `study_app`の`Model`で状態を保持する（採用案）

- **メリット**:
  - すべてGleamのコード内で完結するため、実装が非常にシンプル。
  - The Elm Architectureの思想に沿っており、状態管理が一元的で分かりやすい。
- **デメリット**: ブラウザをリロードすると状態はリセットされるが、今回の要件（リザルト→Homeの遷移）は満たしている。

## 結果

- **ポジティブ**:
  - ユーザーはリザルト画面から戻った際に、前回の設定が保持されているため、スムーズに再挑戦や条件の微調整ができるようになった。
  - 実装がGleam内で完結しているため、外部APIへの依存がなく、メンテナンス性が高い。
- **ネガティブ**:
  - `study_app`の`Model`が、遷移元のモデルを保持するために少し複雑になった。
  - ブラウザのリロードで設定が消える点は変わらない（ただし、これは許容範囲内のトレードオフと判断）。